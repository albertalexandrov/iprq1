# netstat

Утилита netstat предназначена для получения сведений о состоянии сетевых соединений и слушаемых на данном компьютере
портах TCP и UDP, а также, для отображения статистических данных по сетевым интерфейсам и протоколам.

Формат командной строки:

```shell
netstat [-a] [-b] [-e] [-f] [-n] [-o] [-p протокол] [-r] [-s] [-t] [интервал]
```

Параметры командной строки:

- `-a` - Отображение всех подключений и ожидающих портов.
- `-b` - Отображение исполняемого файла, участвующего в создании каждого подключения, или ожидающего порта. 
Иногда известные исполняемые файлы содержат множественные независимые компоненты. Тогда отображается 
последовательность компонентов, участвующих в создании подключения, либо ожидающий порт. В этом случае имя 
исполняемого файла находится снизу в скобках [], сверху - компонент, который им вызывается, и так до тех пор, 
пока не достигается TCP/IP. Заметьте, что такой подход может занять много времени и требует достаточных разрешений.
- `-e` - Отображение статистики Ethernet. Может применяться вместе с параметром -s.
- `-f` - Отображение полного имени домена (FQDN) для внешних адресов.
- `-n` - Отображение адресов и номеров портов в числовом формате.
- `-o` - Отображение кода (ID) процесса каждого подключения.
- `-p` протокол - Отображение подключений для протокола, задаваемых этим параметром. Допустимые значения: TCP, UDP, 
TCPv6 или UDPv6. Используется вместе с параметром -s для отображения статистики по протоколам. Допустимые значения: 
IP, IPv6, ICMP, ICMPv6, TCP, TCPv6, UDP или UDPv6.
- `-r` - Отображение содержимого таблицы маршрутов.
- `-s` - Отображение статистики протокола. По умолчанию статистика отображается для протоколов IP, IPv6, ICMP, ICMPv6, \
TCP, TCPv6, UDP и UDPv6. Параметр -p позволяет указать подмножество выводимых данных.
- `-t` - Отображение текущего подключения в состоянии переноса нагрузки с процессора на сетевой адаптер при передаче 
данных ( "offload" ).
- `-v` - подробный вывод информации, если это возможно.
- `интервал` - Повторный вывод статистических данных через указанный интервал в секундах. Для прекращения вывода данных 
нажмите клавиши CTRL+C. Если параметр не задан, сведения о текущей конфигурации выводятся один раз.

Пример отображаемой информации:

![Пример отображаемой информации netstat](./images/netstat.png)

Активные соединения с Интернетом возникают, когда, к примеру, запускается браузер, открывается какой-либо сайт.

`Proto` - название протокола.<br>
`Local` - локальный IP-адрес участвующий в соединении или связанный со службой.<br>
`Foreign address` Внешний IP-адрес, участвующий в создании соединения.<br>
`State` - состояние соединения. Возможные состояния:
- CLOSE_WAIT - ожидание закрытия соединения.
- CLOSED - соединение закрыто.
- ESTABLISHED - соединение установлено.
- LISTENING - ожидается соединение (слушается порт)
- TIME_WAIT - превышение времени ответа.


Сокет - это абстракция сетевого взаимодействия в операционной системе Linux. Каждому сокету соответствует 
пара IP-адрес + номер порта.

### Источники

0. [https://ab57.ru/cmdlist/netstat.html](https://ab57.ru/cmdlist/netstat.html)
1. [https://habr.com/ru/company/otus/blog/539550/](https://habr.com/ru/company/otus/blog/539550/)



# nc (netcat)

`netcat` — утилита Unix, позволяющая устанавливать соединения TCP и UDP, принимать оттуда данные и передавать их.

## Синтаксис и опции

```shell
nc -параметры адрес порт(ы)
```

Часть параметров указывается с уточняющими значениями, а часть без них. Вот список наиболее востребованных параметров:

- `-6` – использовать протокол IPv6. По умолчанию используется параметр -4 и IPv4 соответственно;
- `-h` – вывести справку со списком доступных параметров;
- `-i задержка` – добавить задержку между отправкой строк или сканированием портов. Задаётся в секундах;
- `-l` – режим прослушивания. Используется с указанием порта;
- `-N` – закрыть соединение при достижении конца файла при его отправке;
- `-n` – Работать с IP-адресами напрямую, не задействуя DNS, также отключить поиск портов;
- `-P` имя_пользователя – указать имя пользователя для подключения к прокси;
- `-x адрес:порт` – указать адрес и порт для подключения к прокси;
- `-p порт` – указать номер порта. В большинстве случаев порт считывается без указания параметра;
- `-U` – использовать сокет домена UNIX (для межпроцессного взаимодействия);
- `-u` – использовать протокол UDP, по умолчанию используется TСP;
- `-v` – подробный режим. Используется при сканировании портов;
- `-W` количество_пакетов – закрыть соединение после получения определённого количества пакетов;
- `-w таймер` – включить таймер для ограничения времени соединения. Задаётся в секундах;
- `-z` – отключить отправку данных. Используется при сканировании портов.

## Примеры использования nc

### Проверка порта

```shell
nc -vz 192.168.31.247 8080
```

### Прослушивание порта

```shell
nc -nlv 8080
```

### Чат и обмен файлами

Для того чтобы запустить чат на одном компьютере запускаем утилиту в режиме прослушивания порта:

```shell
nc -lp 8080
```

На другом компьютере потребуется указать адрес первого компьютера и тот же самый порт. Также не забудьте проверить, что порт открыт:

```shell
nc 0.0.0.0 8080
```


### Источники

0. [https://manpages.ubuntu.com/manpages/bionic/man1/nc_openbsd.1.html](https://manpages.ubuntu.com/manpages/bionic/man1/nc_openbsd.1.html)
1. [https://losst.pro/komanda-nc-v-linux](https://losst.pro/komanda-nc-v-linux)


